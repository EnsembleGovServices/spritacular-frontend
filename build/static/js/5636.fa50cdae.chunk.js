"use strict";(self.webpackChunkspritacular_frontend=self.webpackChunkspritacular_frontend||[]).push([[5636,3417],{14212:function(e,n,s){var i=s(74165),a=s(1413),t=s(15861),r=s(70885),l=s(72791),o=s(94677),c=s(74551),d=s(17834),u=s(7788),v=s(62711),h=s(57574),x=s(80184);n.Z=function(e){var n=(0,d.Z)().setAuth,s=e.user,m=e.token,f=(0,l.useState)(""),j=(0,r.Z)(f,2),p=j[0],g=j[1],b=(0,l.useState)(""),Z=(0,r.Z)(b,2),C=Z[0],N=Z[1],_=(0,l.useState)("0"),S=(0,r.Z)(_,2),y=S[0],k=S[1],J=(0,l.useState)(null),O=(0,r.Z)(J,2),w=O[0],L=O[1],F=function(e){var n=e.target.files[0];g(n),k("0")},I=(0,l.useCallback)((0,t.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(""),(t=new FormData).append("profile_image",p),e.next=5,o.Z.patch(c.v2.api+"/users/user_profile/"+(null===s||void 0===s?void 0:s.id)+"/",t,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(m)},withCredentials:!0,onUploadProgress:function(e){var n=Math.round(e.loaded/e.total*100)+"%";k(n)}}).then((function(e){N(e.data),n((function(n){var i;return(0,a.Z)((0,a.Z)({},n),{},{user:(0,a.Z)((0,a.Z)({},s),{},{profile_image:null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.profile_image.replace(c.v2.remote,"")})})}))})).catch((function(e){L(e.response)}));case 5:case"end":return e.stop()}}),e)}))),[p]);(0,l.useEffect)((function(){p&&I().then((function(e){return e}))}),[p,I]);var X=function(){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("label",{className:"form-label-border",children:(0,x.jsx)(h.Z,{src:null===s||void 0===s?void 0:s.profile_image,alt:null===s||void 0===s?void 0:s.first_name})}),(0,x.jsx)(u.zx,{className:"edit-btn",children:(0,x.jsx)(v.JO,{icon:"lucide:edit-2"})}),(0,x.jsx)("input",{type:"file",name:"profile_image",onChange:F})]})},D=function(){return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{className:"progressBar",style:{"--percentage":y},children:(0,x.jsxs)("div",{className:"wrapper",children:[(0,x.jsx)("b",{children:y}),(0,x.jsx)("span",{children:"uploading.."})]})})})},P=function(){return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{className:"form-label",children:(0,x.jsxs)("div",{className:"wrapper",children:[(0,x.jsx)("span",{children:"Please upload your image"}),(0,x.jsx)("input",{type:"file",name:"profile_image",onChange:F})]})})})};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"user-profile-upload",children:C?(0,x.jsx)(x.Fragment,{children:y>"1"&&!w&&"100%"!==y?(0,x.jsx)(D,{}):(0,x.jsx)(X,{})}):(0,x.jsx)(x.Fragment,{children:null!==s&&void 0!==s&&s.profile_image?(0,x.jsx)(x.Fragment,{children:y>"1"&&"100%"!==y?(0,x.jsx)(D,{}):(0,x.jsx)(X,{})}):(0,x.jsx)(x.Fragment,{children:y>"1"&&400!==(null===w||void 0===w?void 0:w.status)?(0,x.jsx)(D,{}):(0,x.jsx)(P,{})})})}),(0,x.jsx)(x.Fragment,{children:(null===w||void 0===w?void 0:w.data)&&w.data.profile_image.map((function(e,n){return(0,x.jsx)("span",{className:"text-danger small",children:e},n)}))})]})}},57574:function(e,n,s){var i=s(70885),a=s(72791),t=s(80184);n.Z=function(e){var n=e.src,s=e.alt,r=e.imageClass,l=e.converted,o=(0,a.useState)(null),c=(0,i.Z)(o,2),d=c[0],u=c[1],v=(0,a.useState)(""),h=(0,i.Z)(v,2),x=h[0],m=h[1];return(0,a.useEffect)((function(){var e,s=!1;return x&&d!==n&&(IntersectionObserver?(e=new IntersectionObserver((function(i){i.forEach((function(i){!s&&(i.intersectionRatio>0||i.isIntersecting)&&(u(n),e.unobserve(x))}))}),{threshold:.01,rootMargin:"75%"})).observe(x):u(n)),function(){s=!0,e&&e.unobserve&&e.unobserve(x)}}),[n,d,x,l]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("img",{className:r?r+" img-fluid":"img-fluid",ref:m,src:d,alt:s,onLoad:function(e){e.target.classList.add("loaded")},onError:function(e){e.target.classList.add("has-error")}})})}},77849:function(e,n,s){var i=s(72791),a=s(63417);n.Z=function(){var e=(0,i.useContext)(a.ObservationContext).observationImages;return(0,i.useDebugValue)(e,(function(e){return null!==e&&void 0!==e&&e.data?"Images set":"Images not set"})),(0,i.useContext)(a.ObservationContext)}},63417:function(e,n,s){s.r(n),s.d(n,{ObservationContext:function(){return c}});var i=s(42982),a=s(70885),t=s(16871),r=s(72791),l=s(74551),o=s(80184),c=(0,r.createContext)({});n.default=function(){var e=(0,r.useState)({image_type:1}),n=(0,a.Z)(e,2),s=n[0],d=n[1],u=(0,r.useState)({total:3,active:1,mode:{update:!1}}),v=(0,a.Z)(u,2),h=v[0],x=v[1],m=(0,r.useState)([]),f=(0,a.Z)(m,2),j=f[0],p=f[1],g=(0,r.useState)(l.pJ),b=(0,a.Z)(g,2),Z=b[0],C=b[1],N=(0,r.useState)([]),_=(0,a.Z)(N,2),S=_[0],y=_[1],k=(0,r.useState)({}),J=(0,a.Z)(k,2),O=J[0],w=J[1];return(0,r.useEffect)((function(){var e=null!==j&&void 0!==j&&j.data?(0,i.Z)(null===j||void 0===j?void 0:j.data):[];w({image_type:null===s||void 0===s?void 0:s.image_type,map_data:e,elevation_angle:null,video_url:""})}),[null===j||void 0===j?void 0:j.data,null===h||void 0===h?void 0:h.is_draft,null===s||void 0===s?void 0:s.image_type]),(0,o.jsx)(c.Provider,{value:{observationType:s,setObservationType:d,observationSteps:h,setObservationSteps:x,observationImages:j,setObservationImages:p,observationCategory:S,setObservationCategory:y,observationData:O,setObservationData:w,cameraDetails:Z,setCameraDetails:C},children:(0,o.jsx)(t.j3,{})})}},45636:function(e,n,s){s.r(n),s.d(n,{default:function(){return p}});var i=s(74165),a=s(15861),t=s(70885),r=s(7788),l=s(72791),o=s(81694),c=s.n(o),d=s(17834),u=s(14212),v=s(61416),h=s(77849),x=s(80184),m=(0,l.lazy)((function(){return Promise.all([s.e(382),s.e(7925)]).then(s.bind(s,47925))})),f=(0,l.lazy)((function(){return s.e(487).then(s.bind(s,70487))})),j=(0,l.lazy)((function(){return s.e(4889).then(s.bind(s,22048))})),p=function(){var e,n=(0,d.Z)().auth,s=(0,l.useState)(null===n||void 0===n?void 0:n.user),o=(0,t.Z)(s,2),p=o[0],g=o[1],b=(0,l.useState)("1"),Z=(0,t.Z)(b,2),C=Z[0],N=Z[1],_=(0,h.Z)(),S=_.cameraDetails,y=_.setCameraDetails,k=(0,l.useState)(!1),J=(0,t.Z)(k,2),O=J[0],w=J[1],L=function(e){C!==e&&("2"===e&&F().then((function(e){return e})),N(e))},F=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var s,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==n&&void 0!==n&&null!==(s=n.user)&&void 0!==s&&s.camera?(w(!0),y(null===n||void 0===n||null===(a=n.user)||void 0===a?void 0:a.camera)):w(!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,l.useEffect)((function(){var e;g(null===n||void 0===n?void 0:n.user),null!==n&&void 0!==n&&null!==(e=n.user)&&void 0!==e&&e.camera&&w(!0)}),[n]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("section",{className:"common-banner",children:(0,x.jsx)(r.W2,{children:(0,x.jsx)("div",{className:"banner-inner"})})}),(0,x.jsx)("section",{className:"setting-main",children:(0,x.jsx)("div",{className:"setting-inner",children:(0,x.jsx)(r.W2,{children:(0,x.jsxs)(r.X2,{children:[(0,x.jsx)(r.JX,{md:4,children:(0,x.jsxs)("div",{className:"profile-left-tab",children:[(0,x.jsxs)("div",{className:"profile-info",children:[(0,x.jsx)("div",{className:"profile-img",children:(0,x.jsx)(u.Z,{user:p,token:null===n||void 0===n||null===(e=n.token)||void 0===e?void 0:e.access})}),(0,x.jsxs)("div",{className:"profile-data text-center",children:[(0,x.jsxs)("h5",{children:[null===p||void 0===p?void 0:p.first_name," ",null===p||void 0===p?void 0:p.last_name]}),(0,x.jsx)("p",{children:null===p||void 0===p?void 0:p.email}),(0,x.jsxs)("div",{className:"d-flex align-items-center justify-content-center",children:[(0,x.jsx)(v.Z,{country:null===p||void 0===p?void 0:p.country_code}),(0,x.jsx)("span",{children:null===p||void 0===p?void 0:p.location})]})]})]}),(0,x.jsxs)(r.JL,{tabs:!0,className:"flex-column",children:[(0,x.jsx)(r.LY,{children:(0,x.jsx)(r.OL,{className:c()({active:"1"===C}),onClick:function(){L("1")},children:"Update Profile"})}),(0,x.jsx)(r.LY,{children:(0,x.jsx)(r.OL,{className:c()({active:"2"===C}),onClick:function(){L("2")},children:"Camera Settings"})}),(0,x.jsx)(r.LY,{children:(0,x.jsx)(r.OL,{className:c()({active:"3"===C}),onClick:function(){L("3")},children:"Change Password"})})]})]})}),(0,x.jsx)(r.JX,{md:8,children:(0,x.jsx)("div",{className:"profile-right-tab",children:(0,x.jsxs)(r.I5,{activeTab:C,children:[(0,x.jsx)(r.Jm,{tabId:"1",children:(0,x.jsxs)(r.X2,{children:[(0,x.jsx)(r.JX,{sm:"12",children:(0,x.jsx)("h4",{children:"Update Profile"})}),(0,x.jsx)(r.JX,{md:"12",children:(0,x.jsx)(l.Suspense,{fallback:(0,x.jsx)("div",{children:"Loading..."}),children:(0,x.jsx)(m,{user:n})})})]})}),(0,x.jsx)(r.Jm,{tabId:"2",children:(0,x.jsxs)(r.X2,{children:[(0,x.jsx)(r.JX,{sm:"12",children:(0,x.jsx)("h4",{children:"Camera Settings"})}),(0,x.jsx)(r.JX,{md:"12",children:(0,x.jsx)(l.Suspense,{fallback:(0,x.jsx)("div",{children:"Loading..."}),children:(0,x.jsx)(f,{cameraDetails:S,user:n,isDetailExist:O})})})]})}),(0,x.jsx)(r.Jm,{tabId:"3",children:(0,x.jsxs)(r.X2,{children:[(0,x.jsx)(r.JX,{sm:"12",children:(0,x.jsx)("h4",{children:"Change Password"})}),(0,x.jsx)(r.JX,{md:"12",children:(0,x.jsx)(l.Suspense,{fallback:(0,x.jsx)("div",{children:"Loading..."}),children:(0,x.jsx)(j,{user:n})})})]})})]})})})]})})})})]})}}}]);
//# sourceMappingURL=5636.fa50cdae.chunk.js.map