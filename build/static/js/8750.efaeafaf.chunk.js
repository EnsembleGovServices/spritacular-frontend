"use strict";(self.webpackChunkspritacular_frontend=self.webpackChunkspritacular_frontend||[]).push([[8750],{66481:function(e,n,i){var t=i(62711),o=i(80184);n.Z=function(e){var n=e.likeView,i=e.commentCount;return(0,o.jsxs)("div",{className:"d-flex align-items-center justify-content-center user-review",children:[(0,o.jsxs)("span",{className:"me-3 d-flex",children:[(0,o.jsx)(t.JO,{icon:"heroicons-solid:thumb-up",width:"17",height:"17",className:"me-1"})," ",null===n||void 0===n?void 0:n.like_count," "]}),(0,o.jsxs)("span",{className:"me-3 d-flex",children:[(0,o.jsx)(t.JO,{icon:"heroicons-solid:eye",width:"17",height:"17",className:"me-1"})," ",null===n||void 0===n?void 0:n.watch_count," "]}),(0,o.jsxs)("span",{className:"d-flex",children:[(0,o.jsx)(t.JO,{icon:"mdi:message",width:"17",height:"17",className:"me-1"})," ",i," "]})]})}},58750:function(e,n,i){i.r(n),i.d(n,{default:function(){return k}});var t=i(4942),o=i(74165),l=i(1413),s=i(15861),a=i(70885),c=i(7788),d=i(62711),r=i(61416),u=i(72426),v=i.n(u),m=i(74405),h=i(72791),p=i(94677),f=i(74551),x=i(17834),_=i(40872),j=i(80184),b=function(e){var n,i=e.openRejectModal,t=e.handleCloseRejectObs,d=e.data,r=e.user,u=e.token,v=e.approveReject,m=e.handleDetailPopup,x=null===r||void 0===r?void 0:r.is_superuser,_=(0,h.useState)({inappropriate_image:!1,other:!1,additional_comment:""}),b=(0,a.Z)(_,2),w=b[0],k=b[1],g=(0,h.useState)(),N=(0,a.Z)(g,2),Z=N[0],y=N[1],C=(0,h.useState)(),J=(0,a.Z)(C,2),X=J[0],A=J[1],O=(0,h.useRef)(null),z=(0,h.useRef)(null),R=function(e){var n,i;k((0,l.Z)((0,l.Z)({},w),{},{inappropriate_image:null!==O&&void 0!==O&&null!==(n=O.current)&&void 0!==n&&n.checked?1:0,other:null!==z&&void 0!==z&&null!==(i=z.current)&&void 0!==i&&i.checked?1:0}))},T={name:"REJECT",reason:w},S=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y(""),A(""),!x){e.next=5;break}return e.next=5,p.Z.post("".concat(f.v2.api,"/observation/verify_observation/").concat(null===d||void 0===d?void 0:d.id,"/"),T,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u)}}).then((function(e){var n;v(!0),setTimeout((function(){t(!1)}),1200),setTimeout((function(){m(!1)}),1500),A({message:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.success})})).catch((function(e){var n,i;console.log(e),y({notAllowed:null===e||void 0===e||null===(n=e.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.detail})}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,j.jsxs)(c.u_,{isOpen:i,centered:!0,backdrop:!0,keyboard:!0,toggle:t,className:"reject-modal",children:[(0,j.jsx)(c.xB,{toggle:t,children:"Reject Observation"}),(0,j.jsx)(c.fe,{className:"p-3",children:(0,j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),S().then((function(e){return e}))},children:[X&&(null===X||void 0===X?void 0:X.message)&&(0,j.jsx)(c.sU,{color:"success","data-dismiss":"alert",dismissible:"true",className:"text-left",children:null===X||void 0===X?void 0:X.message}),(0,j.jsx)(c.__,{className:"text-uppercase mb-2",children:"Reason for Rejection"}),(null===Z||void 0===Z?void 0:Z.notAllowed)&&(0,j.jsx)(c.sU,{color:"danger","data-dismiss":"alert",dismissible:"true",className:"text-left",children:null===Z||void 0===Z?void 0:Z.notAllowed}),(0,j.jsxs)(c.X2,{children:[(0,j.jsx)(c.JX,{sm:6,children:(0,j.jsx)(c.cw,{check:!0,children:(0,j.jsxs)(c.__,{check:!0,className:"mb-0",children:[(0,j.jsx)("input",{ref:O,className:"form-check-input",type:"checkbox",name:"inappropriate_image",checked:1===(null===w||void 0===w?void 0:w.inappropriate_image),onChange:function(e){return R()}}),"Inappropriate Image"]})})}),(0,j.jsx)(c.JX,{sm:6,children:(0,j.jsx)(c.cw,{check:!0,children:(0,j.jsxs)(c.__,{check:!0,className:"mb-0",children:[(0,j.jsx)("input",{ref:z,className:"form-check-input",type:"checkbox",checked:1===(null===w||void 0===w?void 0:w.other),name:"other",onChange:function(e){return R()}}),"Other"]})})}),(0,j.jsx)(c.JX,{sm:12,children:(0,j.jsxs)(c.cw,{className:"mt-4 mb-4",children:[(0,j.jsx)(c.__,{className:"text-uppercase mb-2",children:"Additional Comments"}),(0,j.jsx)(c.II,{type:"textarea",name:"additional_comment",placeholder:"Write..",rows:"3",value:null!==(n=null===w||void 0===w?void 0:w.additional_comment)&&void 0!==n?n:"",style:{resize:"none"},onChange:function(e){return function(e){k((0,l.Z)((0,l.Z)({},w),{},{additional_comment:e.target.value}))}(e)}})]})}),(0,j.jsxs)(c.JX,{sm:12,children:[(0,j.jsx)(c.zx,{className:"me-2 gray-outline-btn ",onClick:function(){return t()},children:"Cancel"}),(0,j.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Submit"})]})]})]})})]})},w=i(66481),k=function(e){var n,i,u,k,g,N,Z,y,C,J,X,A,O,z,R,T,S,D,Y,B,I=(0,x.Z)().auth,E=e.data,L=e.obvCommentCount,M=e.handlePopup,P=e.approveRejectEvent,U=e.activeType,V=(0,_.Z)(),F=V.observationListData,W=V.setObservationListData,q=(0,h.useState)(null===(n=F.active)||void 0===n||null===(i=n.like_watch_count_data)||void 0===i?void 0:i.is_like),Q=(0,a.Z)(q,2),G=Q[0],H=Q[1],K=(0,h.useState)(!1),$=(0,a.Z)(K,2),ee=$[0],ne=$[1],ie=(0,h.useState)(),te=(0,a.Z)(ie,2),oe=te[0],le=te[1],se=(0,h.useState)(),ae=(0,a.Z)(se,2),ce=ae[0],de=ae[1],re=null===I||void 0===I?void 0:I.user,ue=null===re||void 0===re?void 0:re.is_superuser,ve=null===I||void 0===I||null===(u=I.token)||void 0===u?void 0:u.access,me=null===F||void 0===F?void 0:F.list,he=new FormData,pe=(0,h.useState)({}),fe=(0,a.Z)(pe,2),xe=fe[0],_e=fe[1],je=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var i,t,s,a,c,d;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return he.set("is_like",G?0:1),a=null===F||void 0===F?void 0:F.active,c=null===a||void 0===a||null===(i=a.like_watch_count_data)||void 0===i?void 0:i.is_like,d=null===a||void 0===a||null===(t=a.like_watch_count_data)||void 0===t?void 0:t.like_count,e.next=4,p.Z.post(f.v2.api+"/observation/like/"+n+"/",he,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===I||void 0===I||null===(s=I.token)||void 0===s?void 0:s.access)}}).then((function(e){c||(H(!G),null===me||void 0===me||me.filter((function(e){return(null===e||void 0===e?void 0:e.id)===(null===E||void 0===E?void 0:E.id)})).map((function(e,n){return e.like_watch_count_data.is_like=!0,e.like_watch_count_data.like_count=c?d:d+1,e})),W((function(e){return(0,l.Z)((0,l.Z)({},e),{},{list:me,active:(0,l.Z)((0,l.Z)({},a),{},{like_watch_count_data:(0,l.Z)((0,l.Z)({},null===a||void 0===a?void 0:a.like_watch_count_data),{},{is_like:G,like_count:c?d:d+1})})})})))})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),be=function(){ne(!ee)},we=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var i;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.Z.post(f.v2.api+"/observation/watch_count/"+n+"/",null,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===I||void 0===I||null===(i=I.token)||void 0===i?void 0:i.access)}}).then((function(e){var n,i,t=null===F||void 0===F?void 0:F.active,o=null===t||void 0===t||null===(n=t.like_watch_count_data)||void 0===n?void 0:n.is_watch,s=null===t||void 0===t||null===(i=t.like_watch_count_data)||void 0===i?void 0:i.watch_count;null===me||void 0===me||me.filter((function(e){return(null===e||void 0===e?void 0:e.id)===(null===t||void 0===t?void 0:t.id)})).map((function(e,n){return e.like_watch_count_data.is_watch=!0,e.like_watch_count_data.watch_count=o?s:s+1,e})),W((function(e){return(0,l.Z)((0,l.Z)({},e),{},{active:(0,l.Z)((0,l.Z)({},t),{},{like_watch_count_data:(0,l.Z)((0,l.Z)({},null===t||void 0===t?void 0:t.like_watch_count_data),{},{watch_count:o?s:s+1})})})}))}));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ke=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de(""),le(""),e.next=4,p.Z.post("".concat(f.v2.api,"/observation/verify_observation/").concat(n,"/"),{name:"APPROVE",reason:""},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(ve)}}).then((function(e){var n;de({message:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.success}),P(!0),setTimeout((function(){M(!1)}),1200)})).catch((function(e){var n,i;console.log(null===e||void 0===e?void 0:e.response),le({notAllowed:null===e||void 0===e||null===(n=e.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.detail})}));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ge=function(e,n,i){_e((0,l.Z)((0,l.Z)({},xe),{},(0,t.Z)({},n,{vote:e==="yes".concat(i)?1:0,category_id:n})))},Ne=function(){var e=(0,s.Z)((0,o.Z)().mark((function e(n){var i,t,s;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s in t=[],n.preventDefault(),xe)t.push(xe[s]);return e.next=5,p.Z.post(f.v2.api+"/observation/vote/"+(null===E||void 0===E?void 0:E.id)+"/",{votes:t},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===I||void 0===I||null===(i=I.token)||void 0===i?void 0:i.access)}}).then((function(e){var n,i=null===F||void 0===F?void 0:F.active;null===me||void 0===me||me.filter((function(e){return(null===e||void 0===e?void 0:e.id)===(null===E||void 0===E?void 0:E.id)})).map((function(e,n){return e.user_data.is_voted=!0,e})),i.user_data.is_voted=!0,W((function(e){return(0,l.Z)((0,l.Z)({},e),{},{list:me,active:(0,l.Z)({},i)})})),setTimeout((function(){M(!0)}),1200),de({message:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.success}),le("")})).catch((function(e){console.log(e)}));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,h.useEffect)((function(){var e,n;!(null!==F&&void 0!==F&&null!==(e=F.active)&&void 0!==e&&null!==(n=e.like_watch_count_data)&&void 0!==n&&n.is_watch)&&null!==E&&void 0!==E&&E.id&&re&&we(null===E||void 0===E?void 0:E.id).then((function(e){return e}))}),[null===E||void 0===E?void 0:E.id,null===F||void 0===F||null===(k=F.active)||void 0===k||null===(g=k.like_watch_count_data)||void 0===g?void 0:g.is_watch]),(0,j.jsxs)("div",{className:"more-details",children:[(0,j.jsx)(c.X2,{children:(0,j.jsxs)(c.JX,{md:12,children:[(0,j.jsxs)(c.X2,{className:"align-items-center",children:[(0,j.jsx)(c.JX,{sm:3,children:(0,j.jsx)("h6",{className:"m-0 text-uppercase fw-normal",children:"Azimuth"})}),(0,j.jsx)(c.JX,{sm:9,className:"text-end",children:(0,j.jsxs)("p",{className:"selected_direction rounded-circle mb-0 d-inline-flex align-items-center justify-content-center fw-bold",children:[(0,j.jsx)("span",{children:null===E||void 0===E||null===(N=E.images[0])||void 0===N?void 0:N.azimuth}),(0,j.jsx)("i",{style:{"--selected-angle":"".concat((0,m.ZQ)(null===E||void 0===E||null===(Z=E.images[0])||void 0===Z?void 0:Z.azimuth),"deg")},className:"direction_arrow d-flex align-items-center justify-content-center position-absolute left-0 right-0 top-0 bottom-0"})]})})]}),(0,j.jsx)("div",{className:"border-line my-2"}),(0,j.jsxs)(c.X2,{className:"align-items-center",children:[(0,j.jsx)(c.JX,{sm:3,children:(0,j.jsx)("h6",{className:"m-0 text-uppercase fw-normal",children:"When"})}),(0,j.jsx)(c.JX,{sm:9,children:(0,j.jsxs)("p",{className:"mb-0 h-100 d-flex align-items-center justify-content-end fw-bold text-end position-relative",children:[null!==E&&void 0!==E&&null!==(y=E.images[0])&&void 0!==y&&y.obs_date_time_as_per_utc?v().utc(v()(null===E||void 0===E||null===(C=E.images[0])||void 0===C?void 0:C.obs_date_time_as_per_utc).utc()).format("MMM DD, YYYY"):null,(0,j.jsxs)("span",{className:"d-flex align-items-center justify-content-end fw-normal ms-1",children:[" ",null!==E&&void 0!==E&&null!==(J=E.images[0])&&void 0!==J&&J.obs_date_time_as_per_utc?v().utc(v()(null===E||void 0===E||null===(X=E.images[0])||void 0===X?void 0:X.obs_date_time_as_per_utc).utc()).format("hh:mm:ss A"):null,(0,j.jsx)(c.Ct,{className:"bg-black text-white p-1 fw-normal ms-1",children:null!==E&&void 0!==E&&null!==(A=E.images[0])&&void 0!==A&&A.obs_date_time_as_per_utc?"UTC":null})]})]})})]}),(0,j.jsx)("div",{className:"border-line my-2"}),(0,j.jsxs)(c.X2,{className:"align-items-center",children:[(0,j.jsx)(c.JX,{sm:3,children:(0,j.jsx)("h6",{className:"m-0 text-uppercase fw-normal",children:"LOCATION"})}),(0,j.jsx)(c.JX,{sm:9,children:(0,j.jsxs)("p",{className:"mb-0 h-100 d-flex align-items-center justify-content-end fw-bold text-end",children:[(0,j.jsx)(r.Z,{country:null===E||void 0===E||null===(O=E.images[0])||void 0===O?void 0:O.country_code}),(0,j.jsx)("span",{className:"ms-1",children:null===E||void 0===E||null===(z=E.images[0])||void 0===z?void 0:z.location})]})})]}),(0,j.jsx)("div",{className:"border-line my-2 mb-4"}),(0,j.jsxs)(c.X2,{children:[re&&(0,j.jsx)(c.JX,{sm:12,children:(0,j.jsxs)("button",{className:"btn btn-".concat(G?"":"outline-","primary like-btn w-100 d-flex align-items-center justify-content-center py-2 mb-3"),onClick:function(){return je(null===E||void 0===E?void 0:E.id)},disabled:G,children:[(0,j.jsx)(d.JO,{icon:"heroicons-".concat(G?"solid":"outline",":thumb-up"),width:"25",height:"25",className:"me-2"}),(0,j.jsx)("span",{children:G?"Liked":"Like"})]})}),ce&&(null===ce||void 0===ce?void 0:ce.message)&&(0,j.jsx)(c.sU,{color:"success","data-dismiss":"alert",dismissible:"true",className:"text-left",children:null===ce||void 0===ce?void 0:ce.message}),(null===oe||void 0===oe?void 0:oe.notAllowed)&&(0,j.jsx)(c.sU,{color:"danger","data-dismiss":"alert",dismissible:"true",className:"text-left",children:null===oe||void 0===oe?void 0:oe.notAllowed}),ue&&window.location.href.split("/")[window.location.href.split("/").length-1]===f.X0.dashboard&&"verified"!==U&&"denied"!==U&&(0,j.jsx)(c.JX,{sm:12,children:(0,j.jsxs)("div",{className:"w-100 d-flex justify-content-between align-items-center verify-btns mb-4",children:[(0,j.jsxs)(c.zx,{color:"success",onClick:function(){return e=null===E||void 0===E?void 0:E.id,void ke(e).then((function(e){return e}));var e},className:"me-2 text-uppercase fw-bold px-5",children:[(0,j.jsx)(d.JO,{icon:"ci:circle-check-outline",className:"me-1"}),"Approve"]}),(0,j.jsxs)(c.zx,{color:"primary",className:"text-uppercase fw-bold px-4",onClick:function(){be()},outline:!0,children:[(0,j.jsx)(d.JO,{icon:"zondicons:close-outline",className:"me-1"}),"Reject"]})]})}),(0,j.jsx)(c.JX,{sm:12,children:(0,j.jsx)(w.Z,{likeView:null===F||void 0===F||null===(R=F.active)||void 0===R?void 0:R.like_watch_count_data,commentCount:L})})]}),(0,j.jsx)("div",{className:"border-line my-4"}),(null===E||void 0===E||null===(T=E.user_data)||void 0===T?void 0:T.is_can_vote)&&!(null!==E&&void 0!==E&&E.is_verified||null!==E&&void 0!==E&&E.is_reject)&&!(null!==E&&void 0!==E&&null!==(S=E.user_data)&&void 0!==S&&S.is_voted)&&(null===E||void 0===E?void 0:E.category_data.length)>0&&window.location.href.split("/")[window.location.href.split("/").length-1]===f.X0.gallery&&!(null!==re&&void 0!==re&&re.is_user)&&(0,j.jsxs)(c.l0,{onSubmit:Ne,children:[(0,j.jsx)("h4",{className:"mt-3",children:"Vote for observation"}),null===E||void 0===E||null===(D=E.category_data)||void 0===D?void 0:D.map((function(e,n){return(0,j.jsx)("div",{className:"question-box mt-3 d-inline-block w-100",children:null!==xe&&void 0!==xe&&xe[null===e||void 0===e?void 0:e.id]?(0,j.jsxs)("h5",{className:"mb-0",children:[" You have voted for ",null===e||void 0===e?void 0:e.name," to ",null!==xe&&void 0!==xe&&xe[null===e||void 0===e?void 0:e.id].vote?"Yes":"No"]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("h5",{className:"mb-3 fw-normal text-black",children:["Is this a ",e.name,"?"]}),(0,j.jsxs)("div",{className:"d-flex",children:[(0,j.jsx)(c.zx,{className:"gray-outline-btn me-2 px-3",onClick:function(){return ge("no"+n,null===e||void 0===e?void 0:e.id,n)},children:"No"}),(0,j.jsx)(c.zx,{className:"px-3",onClick:function(){return ge("yes"+n,null===e||void 0===e?void 0:e.id,n)},children:"Yes"})]})]})},n)})),(0,j.jsxs)(c.zx,{disabled:!(void 0!==xe&&(null===(Y=Object.keys(xe))||void 0===Y?void 0:Y.length)===(null===E||void 0===E||null===(B=E.category_data)||void 0===B?void 0:B.length)),className:"like-btn mt-4 w-100 d-flex align-items-center justify-content-center py-2 mb-3",children:[(0,j.jsx)(d.JO,{icon:"heroicons-solid:thumb-up",width:"25",height:"25",className:"me-2"}),(0,j.jsx)("span",{children:"Vote this observation"})]})]})]})}),(0,j.jsx)(b,{data:E,user:re,token:ve,openRejectModal:ee,handleCloseRejectObs:be,handleDetailPopup:M,approveReject:P})]})}}}]);
//# sourceMappingURL=8750.efaeafaf.chunk.js.map