"use strict";(self.webpackChunkspritacular_frontend=self.webpackChunkspritacular_frontend||[]).push([[2678],{92678:function(e,n,t){t.r(n),t.d(n,{default:function(){return m}});var o=t(1413),i=t(42982),a=t(70885),r=t(7551),u=t(60536),l=t.n(u),c=t(74551),d=t(17834),s=t(72791),f=t(43504),g=t(80184),m=function(e){var n=e.data,t=e.setData,u=e.editorData,m=e.setLoading,p=e.setReadMode,v=e.readMode,h=e.readOnly,b=(0,d.Z)().auth,k=(0,f.lr)(),w="edit"!==(0,a.Z)(k,1)[0].get("mode"),Z=(0,s.useState)([]),y=(0,a.Z)(Z,2),C=y[0],_=y[1],D=(0,s.useState)(!1),F=(0,a.Z)(D,2),L=F[0],R=F[1],S=(0,s.useState)([]),A=(0,a.Z)(S,2),B=A[0],P=A[1];var x={toolbar:{items:["undo","redo","fontsize","fontColor","fontBackgroundColor","|","heading","|","alignment","|","bold","italic","|","link","|","bulletedList","numberedList","insertTable","mergeTableCells","|","insertImage","codeBlock","|","code","HorizontalLine","SpecialCharacters","ImageResize","pageBreak"],shouldNotGroupWhenFull:!1},removePlugins:["Title"],extraPlugins:[function(e){e.plugins.get("FileRepository").createUploadAdapter=function(e){return function(e){return R(!1),{upload:function(){return new Promise((function(n,t){var o=new FormData;m(!0),e.file.then((function(e){var a;o.append("image",e),(new Headers).append("Authorization","Bearer ".concat(null===b||void 0===b||null===(a=b.token)||void 0===a?void 0:a.access)),fetch("".concat(c.v2.blog_image_upload),{method:"post",body:o}).then((function(e){return e.json()})).then((function(e){m(!1),n({default:e.url}),_((function(n){return[].concat((0,i.Z)(n),[{id:e.image_id,url:e.url}])}))})).catch((function(e){t(e)}))}))}))}}}(e)}}]};return(0,s.useEffect)((function(){t&&t((function(e){return(0,o.Z)((0,o.Z)({},e),{},{image_ids:C})}))}),[C,B]),(0,s.useEffect)((function(){if(L&&C){var e,n=null===u||void 0===u||null===(e=u.image_ids)||void 0===e?void 0:e.filter((function(e){return B.includes(e.url)})).map((function(e){return e}));_(n)}}),[B,L]),(0,s.useEffect)((function(){p&&p(w)}),[w]),(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(r.CKEditor,{editor:l(),config:x,data:n||"",then:function(e){console.log(e)},onReady:function(e){var n=e.ui.view.stickyPanel;e.isReadOnly=v||h,e.isReadOnly&&(e.ui.view.top.remove(n),e.ui.view.editable.element.classList.add("p-0"),e.ui.view.editable.element.classList.add("border-0"))},onChange:function(e,n){R(!1);var i=n.getData();n.model.document.on("change:data",(function(){R(!0)}));var a=Array.from((new DOMParser).parseFromString(n.getData(),"text/html").querySelectorAll("img")).map((function(e){return e.getAttribute("src")}));P(a),t&&t((function(e){return(0,o.Z)((0,o.Z)({},e),{},{content:i})}))},onFocus:function(e,n){},onBlur:function(e,n){}})})}}}]);
//# sourceMappingURL=2678.85c4081f.chunk.js.map