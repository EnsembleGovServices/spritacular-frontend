{"version":3,"file":"static/js/7707.4dd2bcfa.chunk.js","mappings":"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","sources":["components/Observation/ObservationDetails/Comments.jsx"],"sourcesContent":["import {useEffect, useRef, useState} from \"react\";\nimport {baseURL} from \"../../../helpers/url\";\nimport axios from \"../../../api/axios\";\nimport moment from \"moment\";\nimport useAuth from \"../../../hooks/useAuth\";\nimport {Button, FormGroup} from \"reactstrap\";\nimport \"../../../assets/scss/component/comments.scss\";\nimport { Icon } from '@iconify/react';\nimport useObservationsData from \"../../../hooks/useObservationsData\";\nimport Images from './../../../static/images';\n\nconst Comments = (props) => {\n    const { auth } = useAuth();\n    const {obvId} = props;\n    const [comments, setComments] = useState([]);\n    const [message, setMessage] = useState();\n    const [signal, setSignal] = useState(false);\n    const commentBox = useRef(null);\n    const {observationComments, setObservationComments} = useObservationsData();\n    const user = auth?.user?.id;\n\n    const getComments = async () => {\n        if (user) {\n            await axios.get(baseURL.api+'/observation/comment/'+obvId+'/', {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${auth?.token?.access}`\n                }\n            })\n                .then((response)=> {\n                    setComments(response?.data);\n                    setObservationComments((prev) => {\n                        return {\n                            ...prev,\n                            comments: response?.data?.data\n                        }\n                    })\n                })\n                .catch((error)=> {\n                    console.log(error);\n                })\n        }\n    };\n\n    const sendComment = async (e) => {\n        e.preventDefault();\n        setSignal(false);\n        await axios.post(baseURL.api+'/observation/comment/'+obvId+'/', {text: message} , {\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${auth?.token?.access}`\n            }\n        })\n            .then((response)=> {\n                setSignal(true);\n                commentBox.current.value = \"\";\n                setMessage(\"\")\n            })\n            .catch((error)=> {\n                setSignal(true);\n            })\n    }\n\n    useEffect(()=> {\n        if (user) {\n            commentBox.current.focus = true;\n            getComments().then(r => r);\n        }\n    }, [signal])\n\n    useEffect(() => {\n        setObservationComments((prev) => {\n            return {\n                ...prev,\n                comment_count: comments?.data ? comments?.data?.length : 0\n            }\n        })\n\n    }, [comments])\n\n\n    const handleCommentText = (e) => {\n      const value = e.target.value;\n      setMessage(value);\n    }\n    const showMessages = () => {\n        return observationComments?.comments?.filter(item => item?.is_active).map((item, index) => {\n            return(\n                <li key={index} className=\"d-flex align-items-center w-100\">\n                    <i className=\"profile-icon rounded-circle me-0\"><img src={item?.user_data?.profile_image ? item?.user_data?.profile_image : Images.DefaultProfile} width='100%' height='100%' alt=\"Profile\" className=\"rounded-circle\" /></i>\n                    <div className=\"commentor_details d-flex justify-content-between align-items-start\">\n                        <div className=\"comment-profile_details\">\n                            <h6 className=\"mb-1 text-truncate text-black\">{item?.user_data?.first_name} {item?.user_data?.last_name}</h6>\n                            <p className=\"mb-0 fw-normal\">{item?.text}</p>\n                        </div>\n                        <span className=\"comment-time fw-normal\">{moment(`${item?.created_on}`).format('DD-MMM')}</span>\n                    </div>\n                </li>\n            )\n        })\n    }\n\n    useEffect(()=> {\n        getComments().then(r => r);\n    }, [])\n\n    return (\n        <>\n            <div className=\"comment-wrapper position-relative\">\n                <ul className=\"comment-area p-0 m-0\">\n                    {observationComments?.comments?.length ? showMessages() : <p className=\"text-center\">No comments yet!</p>}\n                </ul>\n                {user &&\n                    <form onSubmit={sendComment}>\n                        <FormGroup className=\"typing-area d-flex justify-content-between align-items-center start-0 bottom-0\">\n                            <input\n                                className=\"form-control\"\n                                type=\"text\"\n                                name=\"text\"\n                                ref={commentBox}\n                                placeholder=\"Write here..\"\n                                onChange={(e) => handleCommentText(e)}\n                            />\n                            <Button disabled={message?.length === 0} className=\"send-btn shadow-none border-0 position-absolute end-0 pe-3\"><Icon icon=\"bi:send\" color={message?.length === 0 ? '#ccc' : '#900'} /></Button>\n                        </FormGroup>\n                    </form>\n                }\n            </div>\n        </>\n    )\n}\n\nexport default Comments;"],"names":["props","auth","useAuth","obvId","useState","comments","setComments","message","setMessage","signal","setSignal","commentBox","useRef","useObservationsData","observationComments","setObservationComments","user","id","getComments","axios","baseURL","headers","token","access","then","response","data","prev","catch","error","console","log","sendComment","e","preventDefault","text","current","value","useEffect","focus","r","comment_count","length","className","filter","item","is_active","map","index","src","user_data","profile_image","Images","width","height","alt","first_name","last_name","moment","created_on","format","showMessages","onSubmit","type","name","ref","placeholder","onChange","target","handleCommentText","disabled","icon","color"],"sourceRoot":""}