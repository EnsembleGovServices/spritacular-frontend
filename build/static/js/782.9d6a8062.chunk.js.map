{"version":3,"file":"static/js/782.9d6a8062.chunk.js","mappings":"oVAcA,EAXmB,WACf,OACI,gBAAKA,UAAU,cAAf,UACI,iBAAKA,UAAU,iBAAf,WACI,gBAAKA,UAAU,YAAYC,IAAKC,EAAAA,EAAAA,aAAqBC,IAAI,gBACzD,eAAIH,UAAU,QAAd,8BACA,cAAGA,UAAU,OAAb,gE,sBC4ChB,EA9C4B,WACxB,OAAwCI,EAAAA,EAAAA,WAAS,GAAjD,eAAOC,EAAP,KAAqBC,EAArB,KACA,GAA8CF,EAAAA,EAAAA,WAAS,GAAvD,eAAOG,EAAP,KAAwBC,EAAxB,KAEMC,EAAmB,WACrBH,GAAiBD,GACjBG,GAAmB,IAEjBE,EAAsB,WACxBF,GAAoBD,IAExB,OACI,iCACI,gBAAKP,UAAU,yBAAf,UACI,iBAAKA,UAAU,eAAf,WACI,gBAAKA,UAAU,YAAYC,IAAKC,EAAAA,EAAAA,YAAoBC,IAAI,gBACxD,eAAIH,UAAU,QAAd,0EACA,iBAAKA,UAAU,gBAAf,WACI,mBAAQW,QAAS,kBAAMF,KAAoBG,KAAK,SACxCZ,UAAU,oCADlB,oBAGA,mBAAQW,QAAS,kBAAMD,KAAuBE,KAAK,SAC3CZ,UAAU,iCADlB,8BAOXK,IACG,SAACQ,EAAA,EAAD,CACIC,KAAMT,EACNU,YAAaN,IAIpBF,IACG,SAACS,EAAA,EAAD,CACIF,KAAMP,EACNQ,YAAaL,EACbD,iBAAkBA,EAClBQ,WAAW,sBCkG/B,EApIiB,SAACC,GAAW,IAAD,IACjBC,GAAQC,EAAAA,EAAAA,KAARD,KACAE,EAASH,EAATG,MACP,GAAgCjB,EAAAA,EAAAA,UAAS,IAAzC,eAAOkB,EAAP,KAAiBC,EAAjB,KACA,GAA8BnB,EAAAA,EAAAA,YAA9B,eAAOoB,EAAP,KAAgBC,EAAhB,KACA,GAA4BrB,EAAAA,EAAAA,WAAS,GAArC,eAAOsB,EAAP,KAAeC,EAAf,KACMC,GAAaC,EAAAA,EAAAA,QAAO,MAC1B,GAAsDC,EAAAA,EAAAA,KAA/CC,EAAP,EAAOA,oBAAqBC,EAA5B,EAA4BA,uBACtBC,EAAI,OAAGd,QAAH,IAAGA,GAAH,UAAGA,EAAMc,YAAT,aAAG,EAAYC,GACnBC,EAAS,OAAGJ,QAAH,IAAGA,GAAH,UAAGA,EAAqBT,gBAAxB,aAAG,EAA+Bc,OAE3CC,EAAW,yCAAG,mGACVC,EAAAA,EAAAA,IAAUC,EAAAA,GAAAA,IAAc,wBAA0BlB,EAAQ,KAC3DmB,MAAK,SAACC,GACHlB,EAAW,OAACkB,QAAD,IAACA,OAAD,EAACA,EAAUC,MACtBV,GAAuB,SAACW,GAAU,IAAD,EAC7B,OAAO,kBACAA,GADP,IAEIrB,SAAQ,OAAEmB,QAAF,IAAEA,GAAF,UAAEA,EAAUC,YAAZ,aAAE,EAAgBA,aAIrCE,OAAM,SAACC,GACJC,QAAQC,IAAIF,MAZJ,2CAAH,qDAgBXG,EAAW,yCAAG,WAAOC,GAAP,mFAChBA,EAAEC,iBACFvB,GAAU,GAFM,SAGVW,EAAAA,EAAAA,KAAWC,EAAAA,GAAAA,IAAc,wBAA0BlB,EAAQ,IAAK,CAAC8B,KAAM3B,GAAU,CACnF4B,QAAS,CACL,eAAgB,mBAChB,cAAgB,UAAhB,cAA2BjC,QAA3B,IAA2BA,GAA3B,UAA2BA,EAAMkC,aAAjC,aAA2B,EAAaC,WAG3Cd,MAAK,SAACC,GACHd,GAAU,GACVC,EAAW2B,QAAQC,MAAQ,GAC3B/B,EAAW,OAEdmB,OAAM,SAACC,GACJlB,GAAU,MAfF,2CAAH,sDAgEjB,OArBA8B,EAAAA,EAAAA,YAAU,WACFxB,IACAL,EAAW2B,QAAQG,OAAQ,EAC3BrB,IAAcG,MAAK,SAAAmB,GAAC,OAAIA,QAE7B,CAACjC,KAEJ+B,EAAAA,EAAAA,YAAU,WACNzB,GAAuB,SAACW,GAAU,IAAD,EAC7B,OAAO,kBACAA,GADP,IAEIiB,cAAuB,OAARtC,QAAQ,IAARA,GAAAA,EAAUoB,KAAV,OAAiBpB,QAAjB,IAAiBA,GAAjB,UAAiBA,EAAUoB,YAA3B,aAAiB,EAAgBN,OAAS,SAIlE,CAACd,KAEJmC,EAAAA,EAAAA,YAAU,WACNpB,IAAcG,MAAK,SAAAmB,GAAC,OAAIA,OACzB,KAGC,+BACI,iBAAK3D,UAAS,4CAAwCiC,EAAsB,GAAf,cAA7D,WACMA,IACE,gBAAKjC,UAAS,kBAAamC,EAAY,cAAgB,iBAAvD,UACI,SAAC,EAAD,MAIPA,GACG,eAAInC,UAAU,uCAAd,SAlDK,WAAO,IAAD,EACvB,cAAO+B,QAAP,IAAOA,GAAP,UAAOA,EAAqBT,gBAA5B,aAAO,EAA+BuC,QAAO,SAAAC,GAAI,cAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAMC,aAAWC,KAAI,SAACF,EAAMG,GAAW,IAAD,QACvF,OACI,gBAAgBjE,UAAU,kCAA1B,WACI,cAAGA,UAAU,mCAAb,UAAgD,gBAC5CC,IAAS,OAAJ6D,QAAI,IAAJA,GAAA,UAAAA,EAAMI,iBAAN,SAAiBC,cAAjB,OAAiCL,QAAjC,IAAiCA,GAAjC,UAAiCA,EAAMI,iBAAvC,aAAiC,EAAiBC,cAAgBjE,EAAAA,EAAAA,eACvEkE,MAAM,OAAOC,OAAO,OAAOlE,IAAI,UAAUH,UAAU,sBACvD,iBAAKA,UAAU,qEAAf,WACI,iBAAKA,UAAU,0BAAf,WACI,gBAAIA,UAAU,gCAAd,iBAA+C8D,QAA/C,IAA+CA,GAA/C,UAA+CA,EAAMI,iBAArD,aAA+C,EAAiBI,WAAhE,WAA6ER,QAA7E,IAA6EA,GAA7E,UAA6EA,EAAMI,iBAAnF,aAA6E,EAAiBK,cAC9F,cAAGvE,UAAU,iBAAb,gBAA+B8D,QAA/B,IAA+BA,OAA/B,EAA+BA,EAAMX,WAEzC,iBAAMnD,UAAU,yBAAhB,SAA0CwE,IAAO,GAAD,cAAIV,QAAJ,IAAIA,OAAJ,EAAIA,EAAMW,aAAcC,OAAO,iBAT9ET,MAgDAU,MAGHxC,GAAaF,GAAO,eAAIjC,UAAU,uBAAd,UAAqC,SAAC,EAAD,MAAqB,GAInFiC,IACG,iBAAM2C,SAAU5B,EAAhB,UACI,UAAC,KAAD,CACIhD,UAAU,iFADd,WAEI,kBACIA,UAAU,eACVY,KAAK,OACLiE,KAAK,OACLC,IAAKlD,EACLmD,YAAY,eACZC,SAAU,SAAC/B,GAAD,OAzEZ,SAACA,GACvB,IAAMO,EAAQP,EAAEgC,OAAOzB,MACvB/B,EAAW+B,GAuE8B0B,CAAkBjC,OAEvC,SAAC,KAAD,CAAQkC,SAA8B,KAAb,OAAP3D,QAAO,IAAPA,OAAA,EAAAA,EAASY,QACnBpC,UAAU,6DADlB,UAC+E,SAAC,KAAD,CAC3EoF,KAAK,UAAUC,MAA2B,KAAb,OAAP7D,QAAO,IAAPA,OAAA,EAAAA,EAASY,QAAe,OAAS","sources":["components/Observation/ObservationDetails/NoComments.jsx","components/Observation/ObservationDetails/NotLoggedForComment.jsx","components/Observation/ObservationDetails/Comments.jsx"],"sourcesContent":["import '../../../assets/scss/component/no-comments.scss';\r\nimport Images from \"../../../static/images\";\r\n\r\nconst NoComments = () => {\r\n    return (\r\n        <div className=\"no-comments\">\r\n            <div className=\"no-com-content\">\r\n                <img className=\"img-fluid\" src={Images.commentImage} alt=\"noComments\"/>\r\n                <h4 className=\"title\">No comments yet</h4>\r\n                <p className=\"text\">Be the first to comment on this observation.</p>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\nexport default NoComments;","import '../../../assets/scss/component/not-logged-for-comment.scss';\r\nimport Images from \"../../../static/images\";\r\nimport React, {useState} from \"react\";\r\n\r\nimport LoginPopup from \"../../Popup/LoginPopup\";\r\nimport RegisterPopup from \"../../Popup/RegisterPopup\";\r\n\r\nconst NotLoggedForComment = () => {\r\n    const [isLoginModal, setIsLoginModal] = useState(false);\r\n    const [isRegisterModal, setIsRegisterModal] = useState(false);\r\n\r\n    const handleLoginModal = () => {\r\n        setIsLoginModal(!isLoginModal);\r\n        setIsRegisterModal(false);\r\n    };\r\n    const handleRegisterModal = () => {\r\n        setIsRegisterModal(!isRegisterModal);\r\n    };\r\n    return (\r\n        <>\r\n            <div className=\"not-logged-for-comment\">\r\n                <div className=\"nlfc-content\">\r\n                    <img className=\"img-fluid\" src={Images.notLoggedIn} alt=\"noComments\"/>\r\n                    <h6 className=\"title\">You need to be logged in for commenting on this observation</h6>\r\n                    <div className=\"mt-4 btn-wrap\">\r\n                        <button onClick={() => handleLoginModal()} type=\"button\"\r\n                                className=\"btn btn-outline-primary px-4 my-2\">Login\r\n                        </button>\r\n                        <button onClick={() => handleRegisterModal()} type=\"button\"\r\n                                className=\"btn btn-primary px-4 my-2 ms-3\">Register\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {isLoginModal &&\r\n                <LoginPopup\r\n                    open={isLoginModal}\r\n                    handleClose={handleLoginModal}\r\n                />\r\n            }\r\n\r\n            {isRegisterModal && (\r\n                <RegisterPopup\r\n                    open={isRegisterModal}\r\n                    handleClose={handleRegisterModal}\r\n                    handleLoginModal={handleLoginModal}\r\n                    modalClass=\"registerModal\"\r\n                />\r\n            )}\r\n        </>\r\n    )\r\n}\r\nexport default NotLoggedForComment;","import {useEffect, useRef, useState} from \"react\";\r\nimport {baseURL} from \"../../../helpers/url\";\r\nimport axios from \"../../../api/axios\";\r\nimport moment from \"moment\";\r\nimport useAuth from \"../../../hooks/useAuth\";\r\nimport {Button, FormGroup} from \"reactstrap\";\r\nimport \"../../../assets/scss/component/comments.scss\";\r\nimport {Icon} from '@iconify/react';\r\nimport useObservationsData from \"../../../hooks/useObservationsData\";\r\nimport Images from './../../../static/images';\r\nimport NoComments from \"./NoComments\";\r\nimport NotLoggedForComment from \"./NotLoggedForComment\";\r\n\r\nconst Comments = (props) => {\r\n    const {auth} = useAuth();\r\n    const {obvId} = props;\r\n    const [comments, setComments] = useState([]);\r\n    const [message, setMessage] = useState();\r\n    const [signal, setSignal] = useState(false);\r\n    const commentBox = useRef(null);\r\n    const {observationComments, setObservationComments} = useObservationsData();\r\n    const user = auth?.user?.id;\r\n    const isComment = observationComments?.comments?.length;\r\n\r\n    const getComments = async () => {\r\n        await axios.get(baseURL.api + '/observation/comment/' + obvId + '/')\r\n            .then((response) => {\r\n                setComments(response?.data);\r\n                setObservationComments((prev) => {\r\n                    return {\r\n                        ...prev,\r\n                        comments: response?.data?.data\r\n                    }\r\n                })\r\n            })\r\n            .catch((error) => {\r\n                console.log(error);\r\n            })\r\n    };\r\n\r\n    const sendComment = async (e) => {\r\n        e.preventDefault();\r\n        setSignal(false);\r\n        await axios.post(baseURL.api + '/observation/comment/' + obvId + '/', {text: message}, {\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': `Bearer ${auth?.token?.access}`\r\n            }\r\n        })\r\n            .then((response) => {\r\n                setSignal(true);\r\n                commentBox.current.value = \"\";\r\n                setMessage(\"\")\r\n            })\r\n            .catch((error) => {\r\n                setSignal(true);\r\n            })\r\n    }\r\n\r\n    const handleCommentText = (e) => {\r\n        const value = e.target.value;\r\n        setMessage(value);\r\n    }\r\n\r\n    const showMessages = () => {\r\n        return observationComments?.comments?.filter(item => item?.is_active).map((item, index) => {\r\n            return (\r\n                <li key={index} className=\"d-flex align-items-center w-100\">\r\n                    <i className=\"profile-icon rounded-circle me-0\"><img\r\n                        src={item?.user_data?.profile_image ? item?.user_data?.profile_image : Images.DefaultProfile}\r\n                        width='100%' height='100%' alt=\"Profile\" className=\"rounded-circle\"/></i>\r\n                    <div className=\"commentor_details d-flex justify-content-between align-items-start\">\r\n                        <div className=\"comment-profile_details\">\r\n                            <h6 className=\"mb-1 text-truncate text-black\">{item?.user_data?.first_name} {item?.user_data?.last_name}</h6>\r\n                            <p className=\"mb-0 fw-normal\">{item?.text}</p>\r\n                        </div>\r\n                        <span className=\"comment-time fw-normal\">{moment(`${item?.created_on}`).format('DD-MMM')}</span>\r\n                    </div>\r\n                </li>\r\n            )\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (user) {\r\n            commentBox.current.focus = true;\r\n            getComments().then(r => r);\r\n        }\r\n    }, [signal])\r\n\r\n    useEffect(() => {\r\n        setObservationComments((prev) => {\r\n            return {\r\n                ...prev,\r\n                comment_count: comments?.data ? comments?.data?.length : 0\r\n            }\r\n        })\r\n\r\n    }, [comments])\r\n\r\n    useEffect(() => {\r\n        getComments().then(r => r);\r\n    }, [])\r\n\r\n    return (\r\n        <>\r\n            <div className={`comment-wrapper position-relative ${!user ? 'non-logged' : ''}`}>\r\n                {!user &&\r\n                    <div className={`p-0 m-0 ${isComment ? 'hasComments' : 'hasNoComments'}`}>\r\n                        <NotLoggedForComment/>\r\n                    </div>\r\n                }\r\n\r\n                {isComment ? (\r\n                    <ul className=\"comment-area not-logged-list p-0 m-0\">\r\n                        {showMessages()}\r\n                    </ul>\r\n                ) : (\r\n                    (!isComment && user ? <ul className=\"comment-area p-0 m-0\"><NoComments/></ul> : '')\r\n                )}\r\n\r\n\r\n                {user &&\r\n                    <form onSubmit={sendComment}>\r\n                        <FormGroup\r\n                            className=\"typing-area d-flex justify-content-between align-items-center start-0 bottom-0\">\r\n                            <input\r\n                                className=\"form-control\"\r\n                                type=\"text\"\r\n                                name=\"text\"\r\n                                ref={commentBox}\r\n                                placeholder=\"Write here..\"\r\n                                onChange={(e) => handleCommentText(e)}\r\n                            />\r\n                            <Button disabled={message?.length === 0}\r\n                                    className=\"send-btn shadow-none border-0 position-absolute end-0 pe-3\"><Icon\r\n                                icon=\"bi:send\" color={message?.length === 0 ? '#ccc' : '#900'}/></Button>\r\n                        </FormGroup>\r\n                    </form>\r\n                }\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Comments;"],"names":["className","src","Images","alt","useState","isLoginModal","setIsLoginModal","isRegisterModal","setIsRegisterModal","handleLoginModal","handleRegisterModal","onClick","type","LoginPopup","open","handleClose","RegisterPopup","modalClass","props","auth","useAuth","obvId","comments","setComments","message","setMessage","signal","setSignal","commentBox","useRef","useObservationsData","observationComments","setObservationComments","user","id","isComment","length","getComments","axios","baseURL","then","response","data","prev","catch","error","console","log","sendComment","e","preventDefault","text","headers","token","access","current","value","useEffect","focus","r","comment_count","filter","item","is_active","map","index","user_data","profile_image","width","height","first_name","last_name","moment","created_on","format","showMessages","onSubmit","name","ref","placeholder","onChange","target","handleCommentText","disabled","icon","color"],"sourceRoot":""}